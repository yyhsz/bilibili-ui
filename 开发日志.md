## 0. 库的CSS注意事项

所有人使用我的库之前要先引用我写的基础样式：`iz.scss`

为了方便使用者覆盖样式，库里的组件样式是不能`scoped`的

Sass中选择器的写法：`[class^="iz-"],[class*=" iz-"]`

`^=`为以xx开头，`*=`为含有xx

## 1. 使用Vite搭建官网

### 1.1 Vue2和Vue3区别

![image-20200814191726500](C:\Users\yyh\AppData\Roaming\Typora\typora-user-images\image-20200814191726500.png)

### 1.2 报错原因

![image-20200817091454830](C:\Users\yyh\AppData\Roaming\Typora\typora-user-images\image-20200817091454830.png)

### 1.3 初始化vue-router

![image-20200817095759315](C:\Users\yyh\AppData\Roaming\Typora\typora-user-images\image-20200817095759315.png)

![image-20200817100016661](C:\Users\yyh\AppData\Roaming\Typora\typora-user-images\image-20200817100016661.png)

### 1.4 搭建首页和文档页HTML

### 1.5 封装TopNav.vue

### 1.6 实现文档页面样式：PC和手机端

用 `provide` `inject` 来实现点击logo弹出侧边栏功能

用`provide` `inject` 传递的响应式数据，是可以在子组件里修改的（与props不同，props不能在子组件里修改）

实现点击LOGO切换aside功能：

App.vue:`provide('showMenu',showMenu)`

Doc.vue , TopNav.vue :`inject<Ref<boolean>>('showMenu')`

### 1.7 响应式切换按钮

生成根据页面大小决定显示aside与否的切换按钮

```
@media (max-width:500px){}
```

根据页面宽度决定初始要不要显示aside

获取页面宽度 ：`document.documentElement.clientWidth`

```
const width = document.documentElement.clientWidth
const showMenu = ref(width <= 500 ? false : true)
```

### 1.8 路由切换（嵌套子路由）

设置嵌套路由映射：

```
routes:[
        {path:'/',component:Home},
        {path:'/doc',component:Doc,
        children:[{name:'switch',path:'switch',component:Switch}]
    }
```

***注意：嵌套路由路径绝对不能加 '/' 否则会无法识别！***

在组件中操作路由：

由于Vue3中没有`this.$router`，因此需要引入router单独操作

```javascript
//App.vue
import router from '../router'
{
	setup(){
    router.afterEach(()=>{
    if(width <= 500)  //在PC端不需要隐藏aside
      showMenu.value = false 
    })
	}
}
```

## 2. switch组件

### 2.1 实现开关切换的动效

白球要从左边滚到右边

为什么不能直接把left改成right？因为transition只能针对一个属性，把left改成right是不能有动画连续性的

```scss
button>span{
	position:absolute;left:2px;
	transition:left 250ms ease-in-out;
}
button.checked>span{
	left:calc(100% - #{$h2} - 2px)  //注意变量用法
}
```

 

### 2.2 添加checked属性，监听switchClick事件

为了让使用者决定组件的初始化状态（true/false）：添加checked属性

由于checked是props，必须让上层组件控制其值，因此有switchClick事件

```
//SwitchDemo.vue
<Switch :checked="checked" @switchClick="checked = $event"  />
setup(){
	const checked = ref(true)
	return {checked}
}
```

```
//Switch.vue
props:{
	checked:Boolean
},
setup(props,ctx) {
    const toggle = ()=>{
      ctx.emit('switchClick',!props.checked)
    }
    return {toggle};
  }
```

***注意，$event在自定义事件中是第二个参数***

#### 2.2.1 Vue3中v-model新的用法

Vue3中v-model可以直接用于监听任意props属性并自动修改

```
//SwitchDemo.vue
<Switch v-model:xxx="yyy" />
等价于：
<Switch :xxx="yyy" @update:xxx="yyy = $event" />
```

只要在子组件中写好事件触发函数即可

```
//Switch.vue
setup(props,ctx) {
    const toggle = ()=>{
      ctx.emit('update:xxx',!props.checked)
    }
    return {toggle};
  }
```

## 3. Button 组件

Vue3可以直接在组件上监听原生事件，而不用加`.native`（Vue2只能监听组件传上来的自定义事件）

Vue3会把组件上的所有事件默认传给组件最外层的根元素，***如果有不止一个根元素，则原生事件无法被监听***

Vue3在`<template>`中的$xxxx保留，在`<script>`中为`ctx.xxxx`

Vue中存在与原生html元素同名组件会警告并引发错误（bug）

![image-20200823124120778](C:\Users\yyh\AppData\Roaming\Typora\typora-user-images\image-20200823124120778.png)

![image-20200823185433881](C:\Users\yyh\AppData\Roaming\Typora\typora-user-images\image-20200823185433881.png)

### 3.1 支持theme属性

包含：`button（默认）` `text` `link`

### 3.2 支持size属性

包含：`big` `mdeium（默认）` `small`

### 3.3 支持level属性

包含：`main` `normal（默认）` `danger`

### 3.4 支持disabled属性

默认false

### 3.5 支持loading属性

默认false



***特别注意类的写法***，直接返回一个对象给html的class绑定

```javascript
setup(props, ctx) {
    const { theme, loading, size, level, disabled } = props; //解构赋值
    const classes = computed(() => {
      return {
        [`iz-theme-${theme}`]: theme,
        [`iz-size-${size}`]: size,
        [`iz-level-${level}`]: level,
        loading,
        disabled,
      };
    });

    return { classes };
  },
```



## 4. Dialog 组件

![image-20200827192739673](C:\Users\yyh\AppData\Roaming\Typora\typora-user-images\image-20200827192739673.png)

![image-20200827193624449](C:\Users\yyh\AppData\Roaming\Typora\typora-user-images\image-20200827193624449.png)

可能是Vue3存在一个Bug，不能以一个单词命名组件，否则就报渲染错误